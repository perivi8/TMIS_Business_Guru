<div class="public-enquiry-container">
  <div class="header-section">
    <div class="brand-logo">
      <h1>TMIS Business Guru</h1>
      <p>Your Trusted Business Partner</p>
    </div>
  </div>

  <div class="form-container" *ngIf="!isSubmitted">
    <div class="form-header">
      <h2>Submit New Enquiry</h2>
      <p>Fill out the form below and our team will get back to you shortly</p>
    </div>

    <form [formGroup]="enquiryForm" (ngSubmit)="onSubmit()" class="enquiry-form">
      <div class="form-grid">
        <!-- Client Name -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Client Name *</mat-label>
          <input matInput formControlName="client_name" required placeholder="Enter your full name">
          <mat-error *ngIf="enquiryForm.get('client_name')?.hasError('required')">
            Client name is required
          </mat-error>
        </mat-form-field>

        <!-- Mobile Number with Country Code -->
        <div class="mobile-number-container">
          <mat-form-field appearance="outline" class="country-code-field">
            <mat-label>Country</mat-label>
            <mat-select formControlName="country_code" required>
              <mat-option *ngFor="let country of countryCodes" [value]="country.code">
                <span class="country-option">
                  <span class="flag">{{ country.flag }}</span>
                  <span class="code">{{ country.code }}</span>
                  <span class="name">{{ country.country }}</span>
                </span>
              </mat-option>
            </mat-select>
          </mat-form-field>
          
          <mat-form-field appearance="outline" class="mobile-number-field">
            <mat-label>Mobile Number *</mat-label>
            <input matInput 
                   formControlName="mobile_number" 
                   pattern="[0-9]{10}" 
                   maxlength="10" 
                   placeholder="Enter 10-digit mobile number"
                   required>
            <mat-hint>Enter 10-digit mobile number (without country code)</mat-hint>
            <mat-error *ngIf="enquiryForm.get('mobile_number')?.hasError('pattern')">
              Please enter a valid 10-digit mobile number
            </mat-error>
            <mat-error *ngIf="enquiryForm.get('mobile_number')?.hasError('required')">
              Mobile number is required
            </mat-error>
            <!-- Mobile number validation message -->
            <div *ngIf="isMobileChecking" class="mobile-checking">
              <mat-spinner diameter="16"></mat-spinner>
              <span>Checking mobile number...</span>
            </div>
            <mat-error *ngIf="mobileExists && mobileValidationMessage" class="mobile-exists-error">
              {{ mobileValidationMessage }}
            </mat-error>
          </mat-form-field>
        </div>

        <!-- Secondary Mobile Number -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Secondary Mobile Number (Optional)</mat-label>
          <input matInput 
                 formControlName="secondary_mobile_number" 
                 pattern="[0-9]{10}" 
                 maxlength="10"
                 placeholder="Enter 10-digit mobile number">
          <mat-hint>Enter 10-digit mobile number (without country code)</mat-hint>
          <mat-error *ngIf="enquiryForm.get('secondary_mobile_number')?.hasError('pattern')">
            Please enter a valid 10-digit mobile number
          </mat-error>
        </mat-form-field>

        <!-- Business Type -->
        <mat-form-field appearance="outline">
          <mat-label>Business Type (Optional)</mat-label>
          <mat-select formControlName="business_type">
            <mat-option value="">Select Business Type</mat-option>
            <mat-option *ngFor="let type of businessTypeOptions" [value]="type">
              {{ type }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <!-- Business Nature -->
        <mat-form-field appearance="outline">
          <mat-label>Business Nature (Optional)</mat-label>
          <input matInput formControlName="business_nature" placeholder="Enter your business nature">
        </mat-form-field>

        <!-- GST Section -->
        <mat-form-field appearance="outline">
          <mat-label>GST (Optional)</mat-label>
          <mat-select formControlName="gst" (selectionChange)="onGstChange()">
            <mat-option value="">Select GST (Optional)</mat-option>
            <mat-option value="Yes">Yes</mat-option>
            <mat-option value="No">No</mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field appearance="outline" *ngIf="enquiryForm.get('gst')?.value === 'Yes'">
          <mat-label>GST Status</mat-label>
          <mat-select formControlName="gst_status">
            <mat-option value="Active">Active</mat-option>
            <mat-option value="Cancel">Cancel</mat-option>
          </mat-select>
        </mat-form-field>

        <!-- Status -->
        <!-- <mat-form-field appearance="outline">
          <mat-label>Status (Optional)</mat-label>
          <mat-select formControlName="status">
            <mat-option *ngFor="let status of statusOptions" [value]="status">
              {{ status }}
            </mat-option>
          </mat-select>
        </mat-form-field> -->
      </div>

      <div class="form-actions">
        <button type="button" mat-button (click)="resetForm()" [disabled]="isSubmitting">
          Reset Form
        </button>
        <button type="submit" mat-raised-button color="primary" [disabled]="!enquiryForm.valid || isSubmitting || mobileExists || isMobileChecking">
          <mat-spinner diameter="20" *ngIf="isSubmitting"></mat-spinner>
          <span *ngIf="!isSubmitting && !mobileExists">Submit Enquiry</span>
          <span *ngIf="isSubmitting">Submitting...</span>
          <span *ngIf="mobileExists && !isSubmitting">Mobile Number Already Exists</span>
        </button>
      </div>
    </form>
  </div>

  <!-- Success Message -->
  <div class="success-container" *ngIf="isSubmitted">
    <div class="success-content">
      <mat-icon class="success-icon">check_circle</mat-icon>
      <h2>Submission Successful!</h2>
      <div class="success-message">
        <p class="main-message">Thank you for your enquiry!</p>
        <p class="team-message">Our team will contact you soon to explain all the details and assist you with your requirements.</p>
        <div class="contact-info">
          <p><strong>What happens next?</strong></p>
          <ul>
            <li>Our expert team will review your enquiry</li>
            <li>We will contact you within 24 hours</li>
            <li>We'll explain all details and answer your questions</li>
            <li>We'll guide you through the next steps</li>
          </ul>
        </div>
        <p class="thank-you">Thank you for choosing TMIS Business Guru!</p>
      </div>
      <div class="success-actions">
        <button mat-raised-button color="primary" (click)="closeWindow()">
          <mat-icon>close</mat-icon>
          Close
        </button>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <div class="footer-section">
    <p>&copy; 2024 TMIS Business Guru. All rights reserved.</p>
    <p>For immediate assistance, call us at <strong>+91 98765 43210</strong></p>
  </div>
</div>
